## Code Scaffold Structure Design

Overview

This document defines the folder structure and key files that the agent will generate for user applications. The structure is optimized for `npm install && npm run dev` compatibility, minimal dependencies, and clear separation between generated and human-editable code.

## Folder Tree

```
my-app/
├── package.json
├── tsconfig.json
├── next.config.js
├── tailwind.config.js
├── .gitignore
├── README.md
├── public/
│   ├── favicon.ico
│   └── vercel.svg
├── src/
│   ├── app/
│   │   ├── globals.css
│   │   ├── layout.tsx
│   │   ├── page.tsx
│   │   └── api/
│   │       └── [...route]/route.ts
│   ├── components/
│   │   ├── TamboProvider.tsx
│   │   ├── Generated/
│   │   │   ├── LoginForm.tsx
│   │   │   ├── Dashboard.tsx
│   │   │   ├── NavBar.tsx
│   │   │   └── [user-generated-components]/
│   │   └── Custom/
│   │       └── [human-editable-components]/
│   ├── lib/
│   │   ├── mcp/
│   │   │   ├── auth.ts
│   │   │   ├── database.ts
│   │   │   ├── filesystem.ts
│   │   │   └── runner.ts
│   │   ├── utils/
│   │   │   ├── validation.ts
│   │   │   └── helpers.ts
│   │   └── types/
│   │       ├── app.ts
│   │       └── components.ts
│   ├── pages/
│   │   ├── api/
│   │   │   ├── auth/
│   │   │   │   ├── login.ts
│   │   │   │   └── logout.ts
│   │   │   └── [dynamic-routes]/
│   │   └── _app.tsx
│   └── styles/
│       ├── globals.css
│       └── components/
│           ├── button.css
│           └── form.css
└── generated/
    ├── components/
    │   └── [all-generated-components]/
    ├── pages/
    │   └── [all-generated-pages]/
    └── types/
        └── generated.ts
```

## Key Files and Their Purpose

### Root Level Files

#### `package.json`

- **Purpose**: Project dependencies and scripts
- **Dependencies**: `react`, `next`, `typescript`, `tailwindcss`, `@types/node`
- **Scripts**: `dev`, `build`, `start`, `lint`
- **Generated**: Yes (by agent)

#### `tsconfig.json`

- **Purpose**: TypeScript configuration
- **Features**: Strict mode, JSX support, path mapping
- **Generated**: Yes (by agent)

#### `next.config.js`

- **Purpose**: Next.js configuration
- **Features**: Image optimization, environment variables
- **Generated**: Yes (by agent)

#### `tailwind.config.js`

- **Purpose**: Tailwind CSS configuration
- **Features**: Custom colors, typography, responsive design
- **Generated**: Yes (by agent)

#### `.gitignore`

- **Purpose**: Git ignore patterns
- **Includes**: `node_modules/`, `.next/`, `dist/`, environment files
- **Generated**: Yes (by agent)

#### `README.md`

- **Purpose**: Project documentation
- **Content**: Setup instructions, project overview, deployment
- **Generated**: Yes (by agent)

### Source Files

#### `src/app/layout.tsx`

- **Purpose**: Root layout component
- **Contains**: TamboProvider wrapper, global styles
- **Generated**: Yes (by agent)

#### `src/app/page.tsx`

- **Purpose**: Main application page
- **Contains**: App routing, component mounting
- **Generated**: Yes (by agent)

#### `src/app/globals.css`

- **Purpose**: Global CSS styles
- **Contains**: Tailwind imports, base styles
- **Generated**: Yes (by agent)

#### `src/components/TamboProvider.tsx`

- **Purpose**: Tambo integration wrapper
- **Contains**: State management, component registry
- **Generated**: Yes (by agent)

#### `src/lib/mcp/auth.ts`

- **Purpose**: Authentication MCP tool implementation
- **Contains**: Login/logout functions, session management
- **Generated**: Yes (by agent)

#### `src/lib/mcp/database.ts`

- **Purpose**: Database MCP tool implementation
- **Contains**: In-memory data storage, CRUD operations
- **Generated**: Yes (by agent)

#### `src/lib/mcp/filesystem.ts`

- **Purpose**: File system MCP tool implementation
- **Contains**: File operations, directory management
- **Generated**: Yes (by agent)

#### `src/lib/mcp/runner.ts`

- **Purpose**: Command execution MCP tool implementation
- **Contains**: Safe command execution, output handling
- **Generated**: Yes (by agent)

## TamboProvider Location

### Primary Location: `src/components/TamboProvider.tsx`

**Purpose**: Tambo integration wrapper providing component registry and state management

**Key Features**:

- Component registration and retrieval system
- Context-based state management
- Provider wrapper for application components
- Error handling for context access

**Integration**: Wrapped around main application in layout component

### Integration in Layout: `src/app/layout.tsx`

**Purpose**: Root layout component with TamboProvider integration

**Key Features**:

- Wraps entire application with TamboProvider
- Includes global CSS imports
- Provides consistent component context across app

## Generated Components Location

### Primary Location: `src/components/Generated/`

This directory contains all components generated by the agent:

- **Naming Convention**: PascalCase (e.g., `LoginForm.tsx`, `Dashboard.tsx`)
- **Structure**: Each component is a standalone React functional component
- **Styling**: Uses Tailwind CSS classes
- **Props**: TypeScript interfaces for type safety
- **Export**: Default export for easy importing

### Example Generated Component: `src/components/Generated/LoginForm.tsx`

**Component Features**:

- Email and password input fields with validation
- Submit button with loading state
- Tailwind CSS styling for consistent design
- TypeScript interfaces for type safety
- Form submission handling with credentials callback

## Human-Editable Components Location

### Primary Location: `src/components/Custom/`

This directory is reserved for human-written components:

- **Purpose**: Custom business logic, complex interactions
- **Naming**: PascalCase with descriptive names
- **Structure**: Can include hooks, utilities, complex state management
- **Integration**: Can use generated components as building blocks

### Example Custom Component: `src/components/Custom/AppLayout.tsx`

```typescript
import React from 'react';
import NavBar from '@/components/Generated/NavBar';

export default function AppLayout({ children }: { children: React.ReactNode }) {
  return (
    <div className="min-h-screen bg-gray-50">
      <NavBar />
      <main className="container mx-auto py-6">
        {children}
      </main>
    </div>
  );
}
```

## MCP Bindings Location

### Primary Location: `src/lib/mcp/`

Each MCP tool has its own module:

#### `src/lib/mcp/auth.ts`

```typescript
export interface AuthCredentials {
  username: string;
  password: string;
}

export interface AuthResult {
  success: boolean;
  user?: { username: string; role: string };
  error?: string;
}

export const authenticate = async (
  credentials: AuthCredentials,
): Promise<AuthResult> => {
  // Implementation using MCP auth tool
  return {
    success: true,
    user: { username: credentials.username, role: "user" },
  };
};
```

#### `src/lib/mcp/database.ts`

```typescript
export interface DatabaseOperation {
  operation: "create" | "read" | "update" | "delete";
  collection: string;
  data?: any;
  query?: any;
  id?: string;
}

export const executeDatabaseOperation = async (
  operation: DatabaseOperation,
) => {
  // Implementation using MCP database tool
  return { success: true, data: null };
};
```

#### `src/lib/mcp/filesystem.ts`

```typescript
export interface FileSystemOperation {
  operation: "create" | "read" | "update" | "delete" | "list";
  path: string;
  content?: string;
  recursive?: boolean;
}

export const executeFileSystemOperation = async (
  operation: FileSystemOperation,
) => {
  // Implementation using MCP filesystem tool
  return { success: true, path: operation.path };
};
```

#### `src/lib/mcp/runner.ts`

```typescript
export interface CommandExecution {
  command: string;
  args?: string[];
  timeout?: number;
  env?: Record<string, string>;
  workingDir?: string;
}

export const executeCommand = async (execution: CommandExecution) => {
  // Implementation using MCP runner tool
  return { success: true, exitCode: 0, stdout: "", stderr: "" };
};
```

## Clear Separation Strategy

### Generated Code Markers

Each generated file includes a comment header:

```typescript
/**
 * AUTO-GENERATED FILE
 *
 * This file was generated by the Agentic Product Composer.
 *
 * DO NOT EDIT THIS FILE DIRECTLY
 *
 * To modify this component:
 * 1. Update the component specification in the agent interface
 * 2. Regenerate the component
 * 3. Or move the component to src/components/Custom/ for manual editing
 */

// Component code follows...
```

### Build Process Integration

#### `package.json` Scripts

```json
{
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "generate": "node scripts/generate-components.js"
  }
}
```

#### `.gitignore` Patterns

```
# Generated code protection
src/components/Generated/
generated/

# Build outputs
.next/
dist/
out/
```

### Development Workflow

1. **Agent Generation**: Components generated in `src/components/Generated/`
2. **Human Review**: Developers review generated components
3. **Customization**: Move to `src/components/Custom/` for manual editing
4. **Integration**: Use generated components in custom components
5. **Build**: Standard Next.js build process

## Dependencies and Compatibility

### Core Dependencies

- `react`: ^18.0.0
- `next`: ^14.0.0
- `typescript`: ^5.0.0
- `tailwindcss`: ^3.0.0
- `@types/node`: ^18.0.0

### Development Dependencies

- `eslint`: ^8.0.0
- `prettier`: ^3.0.0
- `@typescript-eslint/parser`: ^6.0.0

### Runtime Compatibility

- **Node.js**: 18+
- **Browser**: Modern browsers with ES2020 support
- **Build**: Vercel, Netlify, or any Node.js hosting

This structure ensures that the generated applications are immediately runnable with `npm install && npm run dev` while maintaining clear separation between agent-generated and human-editable code.
